<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Register - Financial Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        body {
            min-height: 100vh;
            background: linear-gradient(120deg, #a1ffce 0%, #faffd1 100%);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .glass-card {
            background: rgba(255,255,255,0.16);
            border-radius: 22px;
            box-shadow: 0 8px 34px 0 rgba(55,190,120,0.13);
            backdrop-filter: blur(14px);
            border: 1px solid rgba(255,255,255,0.32);
            transition: box-shadow 0.3s;
        }
        .glass-card:hover {
            box-shadow: 0 14px 40px 0 rgba(59,182,94,0.23);
        }
        .register-icon {
            font-size: 3.5rem;
            color: #1fc181;
            margin-bottom: 6px;
            filter: drop-shadow(0 0 5px #baffcb);
        }
        .input-group-text {
            background: rgba(140,250,208,0.17);
            border: none;
        }
        input.form-control:focus {
            box-shadow: 0 0 0 2px #54e68c44;
            border-color: #25c481;
        }
        .btn-success {
            background: linear-gradient(90deg, #25c481 40%, #a1ffe1 100%);
            border: none;
        }
        .btn-success:hover, .btn-success:focus {
            background: linear-gradient(82deg, #19c27a 40%, #faefd1 100%);
            color: #fff;
            transform: translateY(-2px) scale(1.035);
            box-shadow: 0 4px 18px #16f64821;
        }
        .glass-link {
            color: #1fc181;
            transition: color 0.2s;
        }
        .glass-link:hover {
            color: #2340ca;
            text-decoration: underline;
        }
        .form-label {
            font-weight: 500;
            color: #22945c;
        }
    </style>
</head>
<body>
    <div class="glass-card p-4" style="width: 100%; max-width: 430px;">
        <div class="mb-3 text-center">
            <i class="fa-solid fa-user-plus register-icon"></i>
        </div>
        <h3 class="mb-4 text-center fw-bold">Create Your Account</h3>
        <form method="post" novalidate id="registerForm">
            {% csrf_token %}
            {% for field in form %}
                <div class="mb-3">
                    <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
                    <div class="input-group">
                        {% if field.name == "username" %}
                            <span class="input-group-text"><i class="fa-regular fa-user"></i></span>
                        {% elif field.name == "password1" or field.name == "password2" %}
                            <span class="input-group-text"><i class="fa-solid fa-key"></i></span>
                        {% endif %}
                        {{ field }}
                    </div>
                    {% for error in field.errors %}
                        <div class="text-danger small">{{ error }}</div>
                    {% endfor %}
                    {% if field.name == "password1" %}
                        <div class="progress mt-2" style="height:6px;">
                            <div id="pwStrength" class="progress-bar bg-success"></div>
                        </div>
                    {% endif %}
                </div>
            {% endfor %}
            {% if form.non_field_errors %}
                <div class="alert alert-danger">
                    {% for error in form.non_field_errors %}
                        {{ error }}
                    {% endfor %}
                </div>
            {% endif %}
            <button type="submit" class="btn btn-success w-100 fw-bold">Register</button>
        </form>
        <div class="mt-4 text-center">
            <span>Already have an account?</span>
            <a href="{% url 'login' %}" class="fw-semibold glass-link">Login</a>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Live password strength meter
        const pwInput = document.getElementById("id_password1");
        const pwBar = document.getElementById("pwStrength");
        if (pwInput && pwBar) {
            pwInput.addEventListener("input", function() {
                let val = pwInput.value;
                let strength = 0;
                if (val.length > 5) strength += 1;
                if (val.match(/[A-Z]/)) strength += 1;
                if (val.match(/[0-9]/)) strength += 1;
                if (val.match(/[^A-Za-z0-9]/)) strength += 1;
                let per = [0, 25, 55, 75, 100][strength];
                let color = ["#e74c3c", "#f1c40f", "#f39c12", "#27ae60", "#22945c"][strength];
                pwBar.style.width = per + "%";
                pwBar.style.background = color;
            });
        }
        // Real-time field highlighting
        document.getElementById('registerForm').addEventListener('input', function(e) {
            Array.from(document.querySelectorAll("#registerForm input")).forEach(function(el){
                if(el.value.trim() === ''){
                    el.classList.add('is-invalid');
                }else{
                    el.classList.remove('is-invalid');
                }
            });
        });
    </script>
</body>
</html>
